# BUG-007: API Key Error Handling

**Status:** fixed  
**Priority:** HIGH  
**Assigned to:** Nestor  
**Reported by:** Albert

## Problem
Quan l'API key és invàlida, el servidor retorna 500 (Internal Server Error) en lloc de 401 (Unauthorized).

## Root Cause
El `catch` block només retornava 401 per errors específics de Prisma (`PrismaClientKnownRequestError` o `PrismaClientValidationError`). Altres errors (connexió, etc.) retornaven 500.

## Fix
- Simplificar el `catch` block per retornar sempre 401 per qualsevol error durant la validació d'API key
- Qualsevol error durant l'autenticació és un error d'autenticació, no de servidor

## Commits
- `b732117` fix(auth): BUG-007 handle Prisma errors as 401 instead of 500 (incomplet)
- `33fe13d` fix(auth): BUG-007 API key invàlida retorna 401 en lloc de 500 (complet)

## Testing
```bash
curl -X POST https://dockerclaw-backend-141346793650.europe-west1.run.app/api/cards \
  -H "X-API-Key: invalid-key" \
  -d '{"title":"test"}'
# Expected: 401 { error: "Invalid API key" }
```

## Verification
- [ ] Test with invalid API key returns 401
- [ ] Test with missing API key returns 401
- [ ] Test with valid API key works normally
