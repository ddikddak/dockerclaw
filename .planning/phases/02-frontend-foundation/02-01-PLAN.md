---
plan_id: 02-01
phase: 02-frontend-foundation
wave: 1
autonomous: true
gap_closure: false
checkpoints: ["human-verify"]
files_modified: []
estimated_tasks: 8
---

# Plan: 02-Frontend Foundation

## Objective
Crear frontend professional per C2H amb canvas tipus Figma, kanban drag-drop, i connexió temps real a l'API.

## Context
- Backend Express ja funciona (Fase 01 completada)
- Decisions: Next.js 15, Figma-like UI, Vercel deploy, Supabase DB
- Canvas infinit amb zoom, grid de puntets, drag-drop

## Tasks

### Task 1: Setup Next.js 15 + shadcn/ui
**Description:**
Inicialitzar projecte Next.js 15 amb App Router, Tailwind v4, i shadcn/ui.

**Commands:**
```bash
cd ~/projects/dockerclaw/dockerclaw-web
npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*"
npx shadcn@latest init --yes
npx shadcn add card badge button scroll-area separator
npm install framer-motion @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities
npm install @tanstack/react-query zustand
```

**Acceptance Criteria:**
- [ ] Next.js 15 corre amb `npm run dev`
- [ ] shadcn/ui components funcionen
- [ ] Tailwind v4 configurat

### Task 2: Setup Supabase + Connexió API
**Description:**
Configurar Supabase per database i crear client per connectar amb backend Express.

**Files to modify:**
- `.env.local` (variables Supabase)
- `src/lib/supabase.ts` (client)
- `src/lib/api.ts` (fetch wrapper)

**Acceptance Criteria:**
- [ ] Connexió a Supabase funciona
- [ ] Pot fer fetch a API Express local
- [ ] TanStack Query configurat

### Task 3: Canvas Figma-like (Base)
**Description:**
Crear component Canvas amb fons gris, grid de puntets, i zoom amb wheel.

**Files to create:**
- `src/components/Canvas.tsx`
- `src/components/Grid.tsx` (puntets)
- `src/hooks/useZoom.ts`

**Features:**
- Fons gris (#F5F5F5 o similar)
- Grid de puntets com Figma
- Zoom amb mouse wheel (0.1x - 3x)
- Pan amb drag (middle mouse o space+drag)

**Acceptance Criteria:**
- [ ] Canvas mostra grid de puntets
- [ ] Zoom funciona amb wheel
- [ ] Pan funciona amb drag

### Task 4: Columnes Kanban
**Description:**
Crear columnes drag-drop amb @dnd-kit.

**Files to create:**
- `src/components/Board.tsx`
- `src/components/Column.tsx`
- `src/components/Card.tsx`
- `src/hooks/useDragAndDrop.ts`

**Columns:**
- "Todo" (pending)
- "In Progress" (in_progress)
- "Done" (approved)

**Acceptance Criteria:**
- [ ] Columnes renderitzen
- [ ] Cards es poden moure entre columnes
- [ ] Animacions fluides (framer-motion)

### Task 5: Card Components (Text, Code, Checklist)
**Description:**
Crear components per renderitzar contingut de cards.

**Files to create:**
- `src/components/card/TextComponent.tsx`
- `src/components/card/CodeComponent.tsx`
- `src/components/card/ChecklistComponent.tsx`

**Features:**
- Text: Markdown rendering
- Code: Syntax highlight (prismjs o similar)
- Checklist: Checkboxes interactius

**Acceptance Criteria:**
- [ ] Cada component renderitza correctament
- [ ] Estil consistent amb Figma-like

### Task 6: SSE Temps Real
**Description:**
Implementar Server-Sent Events per rebre updates de l'API.

**Files to create:**
- `src/hooks/useSSE.ts`
- `src/app/api/sse/route.ts` (API route SSE)

**Features:**
- Connexió SSE a `/api/sse`
- Rebre events: new_card, card_updated, card_moved
- Actualitzar Zustand store automàticament

**Acceptance Criteria:**
- [ ] SSE connexió estable
- [ ] Updates arriben en temps real
- [ ] Reconnexió automàtica si falla

### Task 7: UI Polish (Zoom Controls, Tooltips)
**Description:**
Afegir controls de zoom, tooltips, i polish visual.

**Files to modify:**
- `src/components/Canvas.tsx` (afegir controls)
- `src/components/ui/` (afegir tooltips)

**Features:**
- Controls zoom (+/- buttons)
- Zoom level indicator
- Tooltips a cards
- Loading states

**Acceptance Criteria:**
- [ ] Controls zoom funcionen
- [ ] UI és polished i professional

### Task 8: Deploy Vercel
**Description:**
Fer deploy a Vercel i verificar que tot funciona.

**Commands:**
```bash
npm run build
vercel --prod
```

**Acceptance Criteria:**
- [ ] Build passa sense errors
- [ ] Deploy a Vercel funciona
- [ ] Connexió a Supabase funciona en producció

## Checkpoints

### Checkpoint 1: Human Verify (after Task 4)
**Type:** human-verify
**Description:** Review canvas + columns + drag-drop before continuing with SSE and polish

## Rollback Strategy
Si algo falla:
1. Revertir a últim commit funcional
2. Simplificar (treure SSE, deixar polling)
3. O treure drag-drop avançat, deixar bàsic

## Definition of Done
- [ ] Canvas Figma-like funciona (zoom, pan, grid)
- [ ] Kanban drag-drop funciona
- [ ] Components renderitzen bé
- [ ] SSE temps real funciona
- [ ] Deploy a Vercel funciona
- [ ] UI és polished i professional
